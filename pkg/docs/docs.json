{
  "sections": {
    "command-reference": {
      "title": "Command Reference",
      "content": "This document provides a reference for the `gmux` command-line interface, covering all subcommands and their options.",
      "subsections": [
        {
          "title": "`gmux sessionize` (alias: `sz`)",
          "content": "Launches an interactive interface to browse and switch between projects.\n\n### Syntax\n\n\n### Description\n\nWhen run without arguments, `gmux sz` starts a terminal user interface (TUI) that lists projects discovered from configured search paths. The list displays project names, paths, and status indicators for running tmux sessions and Git repositories. The view refreshes its data sources every 10 seconds.\n\nIf an optional `[path]` argument is provided, the TUI is bypassed, and the command directly creates or switches to a tmux session for that path.\n\n### Example\n\n\n### `gmux sessionize add`\n\nAdds a project path to the `explicit_projects` list in the configuration file.\n\n#### Syntax\n\n\n#### Description\n\nThis command adds a project that is outside of the configured `search_paths`. If no `[path]` is provided, it adds the current working directory.\n\n#### Example\n\n\n### `gmux sessionize remove`\n\nRemoves a project from the `explicit_projects` list in the configuration file.\n\n#### Syntax\n\n\n#### Description\n\nThis command removes a project previously added with `gmux sz add`. If no `[path]` is provided, it removes the current working directory.\n\n#### Example",
          "code_blocks": [
            "gmux sz [path]",
            "# Open the interactive sessionizer TUI\ngmux sz\n\n# Directly create or switch to a session for a specific project\ngmux sz ~/Work/grove-tmux",
            "gmux sz add [path]",
            "# Add the project at ~/Code/special-project to the configuration\ngmux sz add ~/Code/special-project",
            "gmux sz remove [path]",
            "# Remove the project at ~/Code/special-project from the configuration\ngmux sz remove ~/Code/special-project"
          ]
        },
        {
          "title": "`gmux key`",
          "content": "Manages tmux session hotkey bindings.\n\n### `gmux key list`\n\nLists configured session key bindings.\n\n#### Syntax\n\n\n#### Description\n\nDisplays the mapping between hotkeys and projects from `tmux-sessions.yaml`. The default output is a table.\n\n**Flags**:\n*   `--style \u003cstyle\u003e`: Set the output format. Options are `table` (default) or `compact`.\n\n#### Example\n\n\n### `gmux key manage` (alias: `km`)\n\nOpens a TUI to manage session key bindings.\n\n#### Syntax\n\n\n#### Description\n\nProvides a terminal interface to view available keys, see which projects they are mapped to, and interactively map or unmap bindings. It includes a project search interface. Changes are saved to the configuration file on exit.\n\n#### Example\n\n\n### `gmux key add`\n\nMaps a discovered project to an available key.\n\n#### Syntax\n\n\n#### Description\n\nStarts an interactive workflow that shows a list of unmapped projects discovered from configured search paths, then prompts the user to select an available key to assign.\n\n#### Example\n\n\n### `gmux key unmap`\n\nUnmaps a project from a key.\n\n#### Syntax\n\n\n#### Description\n\nRemoves the project path mapping for a specific key, making the key available again. If `[key]` is not provided, it prompts for a selection from currently mapped keys.\n\n#### Example\n\n\n### `gmux key update`\n\nChanges the key for an existing session mapping.\n\n#### Syntax\n\n\n#### Description\n\nPrompts for a new, available key for an already mapped project. If `[current-key]` is omitted, it prompts for a selection of which mapping to update.\n\n#### Example\n\n\n### `gmux key edit`\n\nEdits the path of a mapped session.\n\n#### Syntax\n\n\n#### Description\n\nAllows changing the file path associated with a specific key. If a `[key]` is not provided, it prompts for a selection of which mapping to edit.\n\n#### Example",
          "code_blocks": [
            "gmux key list [--style \u003cstyle\u003e]",
            "# Show all key mappings in a table\ngmux key list\n\n# Show only mapped keys in a compact format\ngmux key list --style compact",
            "gmux key manage",
            "# Open the interactive key manager\ngmux key manage",
            "gmux key add",
            "# Start the interactive flow to add a new key mapping\ngmux key add",
            "gmux key unmap [key]",
            "# Unmap the project assigned to the 'd' key\ngmux key unmap d",
            "gmux key update [current-key]",
            "# Change the key for the session currently mapped to 'a'\ngmux key update a",
            "gmux key edit [key]",
            "# Edit the details for the session mapped to the 's' key\ngmux key edit s"
          ]
        },
        {
          "title": "`gmux launch`",
          "content": "Launches a new tmux session with specified options.\n\n### Syntax\n\n\n### Description\n\nCreates a new tmux session. It can specify the initial window name, a working directory for the session, and create multiple panes.\n\n**Flags**:\n*   `--window-name \u003cname\u003e`: Name for the initial window.\n*   `--working-dir \u003cpath\u003e`: Working directory for the new session.\n*   `--pane \u003ccommand\u003e`: Adds a pane. Can be used multiple times. Supports `command@/path/to/workdir` syntax to set a working directory for a specific pane.\n\n### Example",
          "code_blocks": [
            "gmux launch \u003csession-name\u003e [--window-name \u003cname\u003e] [--working-dir \u003cpath\u003e] [--pane \u003ccommand\u003e]...",
            "# Launch a session with two panes, each in a different directory\ngmux launch my-app --pane \"npm run dev@/app/frontend\" --pane \"go run .@/app/backend\""
          ]
        },
        {
          "title": "`gmux session`",
          "content": "Performs direct operations on tmux sessions.\n\n### `gmux session exists`\n\nChecks if a tmux session exists.\n\n#### Syntax\n\n\n#### Description\n\nExits with code 0 if the session exists, and 1 if it does not. Intended for use in scripts.\n\n#### Example\n\n\n### `gmux session kill`\n\nTerminates a tmux session.\n\n#### Syntax\n\n\n#### Example\n\n\n### `gmux session capture`\n\nCaptures the visible content of a tmux pane and prints it to standard output.\n\n#### Syntax\n\n\n#### Description\n\nThe `\u003ctarget\u003e` can be a session name (`my-session`) or a specific pane target (`my-session:0.1`).\n\n#### Example",
          "code_blocks": [
            "gmux session exists \u003csession-name\u003e",
            "if gmux session exists my-session; then\n  echo \"Session is running.\"\nfi",
            "gmux session kill \u003csession-name\u003e",
            "# Kill the session named 'dev-old'\ngmux session kill dev-old",
            "gmux session capture \u003ctarget\u003e",
            "# Capture the content of the first pane in the 'my-session' session\ngmux session capture my-session:0.0"
          ]
        },
        {
          "title": "`gmux status`",
          "content": "Shows the Git status for repositories configured in `tmux-sessions.yaml`.\n\n### Syntax\n\n\n### Example",
          "code_blocks": [
            "gmux status",
            "gmux status"
          ]
        },
        {
          "title": "`gmux list`",
          "content": "Lists configured session key bindings. This is an alias for `gmux key list`.\n\n### Syntax\n\n\n### Example",
          "code_blocks": [
            "gmux list [--style \u003cstyle\u003e]",
            "# Show configured keys in a compact format\ngmux list --style compact"
          ]
        },
        {
          "title": "`gmux wait`",
          "content": "Blocks execution until a specified tmux session is closed.\n\n### Syntax\n\n\n### Description\n\nPolls at a regular interval to check if a session still exists. Exits with status 0 when the session closes. Exits with a non-zero status if a timeout is reached.\n\n**Flags**:\n*   `--timeout \u003cduration\u003e`: Maximum time to wait (e.g., `10m`, `30s`). `0s` means wait indefinitely.\n*   `--poll-interval \u003cduration\u003e`: How often to check if the session exists (e.g., `1s`, `500ms`).\n\n### Example",
          "code_blocks": [
            "gmux wait \u003csession-name\u003e [--timeout \u003cduration\u003e] [--poll-interval \u003cduration\u003e]",
            "# Wait up to 5 minutes for the 'review-task' session to close\ngmux wait review-task --timeout 5m"
          ]
        },
        {
          "title": "`gmux start`",
          "content": "Starts a pre-configured tmux session by its hotkey.\n\n### Syntax\n\n\n### Description\n\nFinds the project mapped to the given `\u003ckey\u003e` in `tmux-sessions.yaml` and launches a new tmux session for it. The session is named `grove-\u003ckey\u003e`.\n\n### Example",
          "code_blocks": [
            "gmux start \u003ckey\u003e",
            "# Start the session configured for the 'a' key\ngmux start a"
          ]
        },
        {
          "title": "`gmux version`",
          "content": "Prints version information for the `gmux` binary.\n\n### Syntax\n\n\n### Flags\n\n*   `--json`: Output version information in JSON format.\n\n### Example",
          "code_blocks": [
            "gmux version [--json]",
            "gmux version"
          ]
        }
      ]
    },
    "configuration": {
      "title": "Configuration Reference",
      "content": "This document describes the configuration files used by `gmux`. Paths with a leading `~` are expanded to the user's home directory.\n\nBy default, `gmux` looks for configuration files in `~/.config/grove`. This can be changed with the global `--config-dir` flag.",
      "subsections": [
        {
          "title": "grove.yml (Static Configuration)",
          "content": "`gmux` uses the unified Grove configuration system. Configuration is stored in `grove.yml`, which supports layered configuration (global, project, and override files).\n\n**Location**: `~/.config/grove/grove.yml` (or project-specific `grove.yml` files)\n\n**Note**: Session key mappings (which change frequently) are stored separately in `~/.config/grove/gmux/sessions.yml` to keep version-controlled config files clean.\n\n### Project Discovery\n\n**As of this version**, project discovery is managed centrally by `grove-core`'s DiscoveryService. Projects are discovered from paths defined in the global `groves` configuration section.\n\nThe `groves` section in your global `~/.config/grove/grove.yml` defines:\n- Root directories to search for projects and ecosystems\n\nThe `tmux` section defines:\n- Available hotkeys for session switching\n\n### Schema\n\n**Global Configuration** (`~/.config/grove/grove.yml`):\n\n*   `groves` (map of string to object): Defines root directories to scan for projects.\n    *   `path` (string): Directory path to scan.\n    *   `description` (string, optional): A description for the grove.\n    *   `enabled` (bool): If `true`, this path is scanned for projects.\n\n*   `explicit_projects` (array of objects): Defines specific projects to include without discovery.\n    *   `path` (string): The path to the project.\n    *   `name` (string, optional): A display name, defaults to the directory name.\n    *   `description` (string, optional): A description for the project.\n    *   `enabled` (bool): If `true`, this project is included.\n\n*   `tmux` (object): Tmux-specific configuration.\n    *   `available_keys` ([]string): A list of characters to be used as session hotkeys (e.g., `a`, `s`, `d`).\n\n### Discovery Logic\n\nThe sessionizer discovers projects using `grove-core`'s DiscoveryService:\n1.  Scans all enabled `groves` paths for projects with `grove.yml` files.\n2.  Identifies ecosystems (directories with `grove.yml` containing a `workspaces` key).\n3.  Discovers projects (directories with `grove.yml` but no `workspaces` key).\n4.  For each project, scans for `.grove-worktrees` subdirectories and includes worktrees hierarchically.\n5.  Includes non-Grove directories (directories with `.git` but no `grove.yml`).\n6.  Adds all enabled `explicit_projects` (useful for including specific directories like dotfiles).\n\n### Migration from Old Configuration\n\n**If you previously used `search_paths`, `explicit_projects`, or `discovery` settings**, these are now deprecated. Migrate to the new `groves` configuration:\n\n**Old configuration** (deprecated):\n\n**New configuration**:\n\n### Example",
          "code_blocks": [
            "tmux:\n  search_paths:\n    work:\n      path: ~/Work\n      enabled: true",
            "groves:\n  work:\n    path: ~/Work\n    enabled: true\n    description: \"Work projects\"",
            "# ~/.config/grove/grove.yml\n\nversion: \"1.0\"\n\n# Project discovery paths (global configuration)\ngroves:\n  work:\n    path: ~/Work\n    description: \"Work projects\"\n    enabled: true\n  personal:\n    path: ~/Projects\n    description: \"Personal projects\"\n    enabled: true\n\n# Explicit projects (specific directories to include)\nexplicit_projects:\n  - path: ~/.config\n    name: \"dotfiles\"\n    description: \"Configuration files\"\n    enabled: true\n\n# Tmux configuration (static settings only)\ntmux:\n  # Available hotkeys for session switching\n  available_keys: [a, s, d, f, g, h, j, k, l]"
          ]
        },
        {
          "title": "gmux/sessions.yml (Dynamic State)",
          "content": "This file stores session key mappings (which change frequently when you map/unmap projects). It is automatically managed by `gmux key` commands and is stored separately from `grove.yml` to avoid polluting version control.\n\n**Location**: `~/.config/grove/gmux/sessions.yml`\n\nThe recommended way to modify this file is with the `gmux key manage` command, which provides an interactive interface for mapping projects to keys.\n\n### Schema\n\n*   `sessions` (map of key to object): Defines the project mapped to each key. Unmapped keys from `available_keys` are not written to this file.\n    *   `path` (string): The project path the key is mapped to.\n    *   `repository` (string): The display name for the project.\n    *   `description` (string, optional): A free-text description.\n\n### Example\n\n\n### Version Control Recommendation\n\nAdd `gmux/sessions.yml` to your `.gitignore` to prevent session mappings from polluting your version control history:",
          "code_blocks": [
            "# ~/.config/grove/gmux/sessions.yml\nsessions:\n  # Maps key 'a' to the grove-tmux project\n  a:\n    path: \"~/Work/grove-tmux\"\n    repository: \"grove-tmux\"\n    description: \"\"\n\n  # Maps key 'd' to another project\n  d:\n    path: \"~/Projects/my-app\"\n    repository: \"my-app\"\n    description: \"My awesome application\"\n\n  # Keys 's', 'f', 'g', etc. are available but currently unmapped",
            "# In ~/.config/grove/.gitignore\ngmux/sessions.yml\ngmux/access-history.json"
          ]
        }
      ]
    },
    "examples": {
      "title": "Examples",
      "content": "This guide provides examples for common gmux workflows.",
      "subsections": [
        {
          "title": "Example 1: Interactive Session Management (`gmux sz`)",
          "content": "The `gmux sz` command launches a terminal interface to browse and select projects. The list is generated from configured search paths and updates every 10 seconds to reflect changes to tmux sessions, Git status, and key mappings.\n\n#### Launch the Sessionizer\n\nOpen the interface from your terminal:\n\n#### Interface Elements\n\nEach line provides a summary of a project's state:\n\n-   **Hotkey**: The first character (`a`) is the hotkey mapped to this project.\n-   **Session Indicator (`●`)**:\n    -   Blue (`●`): The current tmux session.\n    -   Green (`●`): A running tmux session in the background.\n-   **Claude Indicator (`▶`)**: Shows Claude AI session status if `grove-hooks` is installed (`▶` running, `⏸` idle, `✓` completed, `✗` failed).\n-   **Project Name**: `my-feature` is the directory name. A `└─` prefix indicates a Git worktree.\n-   **Path**: The full path to the project directory.\n-   **Git Status**: A summary for running sessions.\n    -   `↑N`: Commits ahead of remote.\n    -   `M:N`: Modified files.\n    -   `S:N`: Staged files.\n    -   `+N -N`: Lines added/deleted across staged and unstaged changes.\n    -   `✓`: The repository is clean.\n\n#### Navigation and Selection\n\n-   **Filter**: Type characters to filter the list by project name or path.\n-   **Move**: Use `Up`/`Down` arrow keys or `k`/`j`.\n-   **Select**: Press `Enter` to create a new tmux session or switch to an existing one for the selected project.",
          "code_blocks": [
            "gmux sz",
            "  a ● ▶ my-feature  ~/Work/my-repo/.grove-worktrees/my-feature  ↑1 M:3 S:1 +10 -4\n  s ●   my-repo     ~/Work/my-repo                              ✓\n    ●   another     ~/Personal/another-project"
          ]
        },
        {
          "title": "Example 2: Interactive Key Mapping (`gmux key manage`)",
          "content": "The `gmux key manage` command (or `gmux km`) opens a terminal interface for mapping projects to single-character hotkeys defined in `tmux-sessions.yaml`.\n\n#### Launch the Key Manager\n\n\nThe interface shows a table of available keys, the project mapped to each key, and the project's path.\n\n#### Mapping and Unmapping\n\n-   **Map a Project**:\n    1.  Select an unmapped key using the arrow keys.\n    2.  Press `e` to open a searchable list of unmapped projects.\n    3.  Type to filter, select a project, and press `Enter` to confirm.\n-   **Unmap a Project**:\n    1.  Select a mapped key.\n    2.  Press `d` or `spacebar` to clear the mapping.\n\n#### Save and Exit\n\nPress `q` or `Esc` to exit. Changes are saved to `tmux-sessions.yaml`, tmux bindings are regenerated, and the tmux configuration is reloaded if possible.",
          "code_blocks": [
            "gmux key manage"
          ]
        },
        {
          "title": "Example 3: Scripting",
          "content": "`gmux` commands can be used in scripts for automation. This script sets up a tmux environment for a task and waits for the session to be closed before continuing.\n\n**`setup-debug-session.sh`**\n\nThis script uses `gmux launch` to create a multi-pane layout and `gmux wait` to pause execution until the task is complete.",
          "code_blocks": [
            "#!/usr/bin/env bash\nset -euo pipefail\n\nSESSION_NAME=\"debug-api\"\nPROJECT_PATH=\"$HOME/Work/my-api\"\n\n# Launch a new tmux session if it does not already exist.\n# The session has two panes: one for an editor and one for running tests.\nif ! gmux session exists \"$SESSION_NAME\" \u003e/dev/null 2\u003e\u00261; then\n  echo \"Launching new session: $SESSION_NAME\"\n  gmux launch \"$SESSION_NAME\" \\\n    --working-dir \"$PROJECT_PATH\" \\\n    --pane \"nvim .\" \\\n    --pane \"go test -v ./...\"\nelse\n  echo \"Session '$SESSION_NAME' already exists.\"\nfi\n\n# Inform the user how to attach.\necho \"Attach to the session with: tmux attach-session -t $SESSION_NAME\"\necho \"The script will continue after the session is closed.\"\necho\n\n# Block until the session is closed (e.g., via `tmux kill-session`).\ngmux wait \"$SESSION_NAME\"\n\n# Continue with subsequent tasks.\necho \"Session '$SESSION_NAME' closed. Running cleanup tasks...\"\n# ./run_cleanup.sh"
          ]
        }
      ]
    },
    "overview": {
      "title": "Overview",
      "content": "`nav` is a command-line tool for managing tmux sessions, windows, and navigation between project directories within the Grove ecosystem.\n\n### Features\n\n*   **Project Sessionizer (`nav sessionize` or `sz`)**: A terminal interface that lists projects discovered via grove `core`. It aggregates metadata including Git status, `nb` note counts, `flow` plan statistics, and `cx` token counts. Supports filtering, ecosystem focusing (`@`), and hierarchical worktree display.\n*   **Key Mapping (`nav key manage` or `km`)**: A terminal interface for assigning single-character hotkeys to specific project paths. These mappings generate global tmux bindings for rapid access.\n*   **Session History (`nav history` or `h`)**: A terminal interface listing accessed project sessions, sorted by recency. The `nav last` (or `l`) command switches to the most recently used session without opening the interface.\n*   **Window Management (`nav windows`)**: A terminal interface for identifying and manipulating windows within the current session. Features include filtering by name or process, renaming, closing, and moving windows, with a pane content preview.\n*   **Hotkey Generation**: Generates a tmux configuration file containing `bind-key` commands for mapped projects.\n*   **Session Automation (`nav launch`, `nav wait`)**: Commands to create sessions with specific layouts/panes or block execution until a session closes.\n\n### How It Works\n\n**Discovery \u0026 Configuration**\n`nav` utilizes the `DiscoveryService` from `core` to locate projects based on the `groves` configuration in `~/.config/grove/grove.yml`. It supports standard repositories, ecosystems, and Git worktrees.\n\n**Data \u0026 Caching**\n*   **Static Configuration**: Reads search paths and settings from `~/.config/grove/grove.yml`.\n*   **Session State**: Key mappings are stored in `~/.local/state/nav/sessions.yml` (platform dependent).\n*   **Cache**: Project metadata (Git status, note counts) is cached in `~/.cache/nav/cache.json` to improve startup performance.\n*   **Enrichment**: The sessionizer executes background subprocesses (`git`, `nb`, `cx`, `grove`) to populate status columns asynchronously.\n\n**Tmux Integration**\n*   **Bindings**: `nav` generates `~/.cache/nav/generated-bindings.conf`. Users source this file in `~/.tmux.conf`.\n*   **Hooks**: The generated configuration includes a `client-session-changed` hook that executes `nav record-session`, maintaining the access history.\n*   **Execution**: Operations interact with the tmux server via the `tmux` binary. The tool respects the `GROVE_TMUX_SOCKET` environment variable for socket isolation.\n\n### Installation\n\nInstall via the Grove meta-CLI:\n\n\nVerify installation:\n\n\n### Usage Examples\n\n**Interactive Sessionizer**\n\n**Key Management**\n\n### Limitations\n\n*   **Tmux Dependency**: Core functionality requires a running tmux server.\n*   **Terminal Support**: TUI features require a terminal emulator with support for standard ANSI escape sequences.\n*   **Enrichment Performance**: Metadata columns (e.g., Git status, `nb` counts) rely on external binaries; performance depends on the execution speed of these underlying tools.",
      "code_blocks": [
        "grove install nav",
        "nav version",
        "nav sz\n\nnav sz .",
        "nav km\n\nnav key update w"
      ]
    }
  }
}